<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.test.jm.dao.TaskResultDao">

    <resultMap id="task_result_list" type="com.test.jm.dto.test.TaskExtendDTO">
        <id column="id" property="id"></id>
        <result column="task_id" property="task_id"></result>
        <result column="u_id" property="project_id"/>
        <result column="u_name" property="case_id"/>
        <result column="execute_time" property="api_id"/>
    </resultMap>

    <select id="getTaskResultList" parameterType="java.lang.String" resultType="com.test.jm.dto.TaskResultDTO">
        SELECT * FROM task_case_result
        <trim prefix="WHERE">
            <if test="task_id != null">
                task_id = #{task_id}
            </if>
        </trim>
        ORDER BY id DESC
    </select>

    <select id="getTaskResult" parameterType="com.test.jm.dto.TaskResultDTO" resultMap="task_result_list">
        SELECT * FROM task_case_result
        <trim prefix="WHERE">
            <if test="u_id != null">
                u_id = #{u_id}
            </if>
            <if test="task_id != null">
                task_id = #{task_id}
            </if>
        </trim>
    </select>

    <insert id="addTaskResult" parameterType="com.test.jm.dto.TaskResultDTO">
        INSERT INTO `task_case_result` (`task_id`,u_id,u_name,`execute_time`)
        VALUES
        (#{task_id}, #{u_id}, #{u_name}, #{execute_time})
    </insert>

    <update id="updateTaskResult" parameterType="com.test.jm.dto.TaskResultDTO">
        UPDATE task_case_result SET execute_time = #{execute_time}
        <trim prefix="WHERE">
            <if test="u_id != null">
                u_id = #{u_id}
            </if>
            <if test="task_id != null">
                task_id = #{task_id}
            </if>
        </trim>
    </update>

</mapper>